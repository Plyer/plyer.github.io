name: build

on:
  workflow_dispatch:
  
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
      with:
        submodules: true

    - name: Update Blog Content
      run: |
        git submodule update --init --remote
        git config --global user.name "github-action"
        git add .
        git commit -m "Update Blog Content"
        git push

    - name: Setup Hugo
      uses: peaceiris/actions-hugo@v2
      with:
          hugo-version: "latest"
          extended: true

    - name: Build
      run: hugo --minify --gc

    - name: Deploy ðŸš€
      uses: JamesIves/github-pages-deploy-action@v4
      with:
          branch: gh-pages
          folder: public
          clean: true
          single-commit: true
